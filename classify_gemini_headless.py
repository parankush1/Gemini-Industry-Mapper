#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import argparse
import json
import time

from openpyxl import load_workbook
from google import genai
from google.genai import types

INPUT_RATE = 0.30 / 1_000_000   # $ per input token
OUTPUT_RATE = 2.5 / 1_000_000   # $ per output token

SYSTEM_PROMPT = """You are an expert occupation and business classifier. You will receive in a single request: 1) APPLICANT_NAME -> Name of the applicant currently being processed. 2) CAM_COMMENT -> Full CAM narrative for the loan file (may contain multiple persons). Your job is to: STEP 1: Understand the CAM_COMMENT completely. - Identify all persons mentioned. - For each person, infer their occupation/business activity from the text. STEP 2: Focus ONLY on APPLICANT_NAME. - Match APPLICANT_NAME against the persons you identified. - Matching is case-insensitive and can be partial: * "Boopathi Raja" can match text referring to "Boopathi", "Raja", or "Boopathi Raja". * If multiple people have similar names, prefer the one that best matches the full APPLICANT_NAME string. - If you cannot find any clear match, pick the person whose occupation is most likely to correspond to that APPLICANT_NAME given the context. STEP 3: Classify that applicant into EXACTLY ONE label from the catalog below: - Industry - Business Category - Business Profile STEP 4: Return a SHORT structured summary (1–2 sentences) describing ONLY that applicant's occupation/business. OUTPUT FORMAT (STRICT JSON): { "industry": "...", "business_category": "...", "business_profile": "...", "summary": "Short structured summary about APPLICANT_NAME only." } Rules: - Choose ONLY from the catalog (exact text) for the three classification fields and map the closest one. - Be as specific as possible. - If no reasonable match exists, use: { "industry": "Unknown", "business_category": "Unknown", "business_profile": "Unknown", "summary": "No clear occupation or business information available for this applicant." } 
CATALOG (Industry>Business Category>Business Profile): Accounting & Auditing>Private employee>Accounting Accounting & Auditing>Service Provider>Accounting Accounting & Auditing>Service Provider>Tax Services Accounting & Auditing>Private Employee>Typing/Shorthand/basic Computers Advertising / Marketing / Film/TV Industry>Service Provider>Advertising / Marketing Agency Advertising / Marketing / Film/TV Industry>Service Provider>Animator Advertising / Marketing / Film/TV Industry>Service Provider>Freelancer Marketer Advertising / Marketing / Film/TV Industry>Private Employee>Management Advertising / Marketing / Film/TV Industry>Private employee>Management Advertising / Marketing / Film/TV Industry>Service Provider>Model/Actor/Influencer Advertising / Marketing / Film/TV Industry>Private Employee>Office Executive Advertising / Marketing / Film/TV Industry>Service Provider>Production House Advertising / Marketing / Film/TV Industry>Private Employee>Sales Executive Advertising / Marketing / Film/TV Industry>Service Provider>Technical work Advertising / Marketing / Film/TV Industry>Private Employee>Worker Agriculture equipment's>Trader>Agriculture equipment's Trader/dealer Agriculture equipment's>Private Employee>Salaried employee Agriculture equipment's>Service Provider>Sale & Repair Agriculture equipment's>Private Employee>Sales Executive Automobiles / Auto-ancillaries>Trader>Accessories Automobiles / Auto-ancillaries>Private Employee>Accounting Automobiles / Auto-ancillaries>Private Employee>Attender / Administrative Support Staff Automobiles / Auto-ancillaries>Manufacturer>Automobiles / Auto-ancillaries/Accessories Company Automobiles / Auto-ancillaries>Trader>Batteries Automobiles / Auto-ancillaries>Private Employee>Casual Labour Automobiles / Auto-ancillaries>Private Employee>Denting and Painting Works Automobiles / Auto-ancillaries>Service Provider>Denting and Painting Works Automobiles / Auto-ancillaries>Trader>Distributor/Whole Seller/Dealership Automobiles / Auto-ancillaries>Private Employee>Driver Automobiles / Auto-ancillaries>Private Employee>Engineer Automobiles / Auto-ancillaries>Private Employee>Guard Automobiles / Auto-ancillaries>Service Provider>Job Work Automobiles / Auto-ancillaries>Private Employee>Machine Operator Automobiles / Auto-ancillaries>Private Employee>Management Automobiles / Auto-ancillaries>Private Employee>Management Automobiles / Auto-ancillaries>Private Employee>Mechanic (With Setup) Automobiles / Auto-ancillaries>Service Provider>Mechanic (With Setup) Automobiles / Auto-ancillaries>Service Provider>Mechanic (Without Setup) Automobiles / Auto-ancillaries>Service Provider>Mechanical Engineer Automobiles / Auto-ancillaries>Private Employee>Office executive Automobiles / Auto-ancillaries>Private Employee>Office Executive Automobiles / Auto-ancillaries>Trader>Old Car Sale & Purchase Automobiles / Auto-ancillaries>Service Provider>Operations Automobiles / Auto-ancillaries>Private Employee>Production Department Automobiles / Auto-ancillaries>Service Provider>Puncher (With Setup) Automobiles / Auto-ancillaries>Service Provider>Puncher (Without Setup) Automobiles / Auto-ancillaries>Private Employee>Sales Executive Automobiles / Auto-ancillaries>Private Employee>Service & Repairs Automobiles / Auto-ancillaries>Service Provider>Service Centre Automobiles / Auto-ancillaries>Trader>Spare Part Shop Automobiles / Auto-ancillaries>Private Employee>Supervisor Automobiles / Auto-ancillaries>Private Employee>Technical work Automobiles / Auto-ancillaries>Service Provider>Tyre business and service centre Automobiles / Auto-ancillaries>Trader>Tyre business and service centre Automobiles / Auto-ancillaries>Service Provider>Valcanizing Workshop Automobiles / Auto-ancillaries>Private Employee>Worker Aviation>Private Employee>Flight Attendant Baby Care>Private Employee>Quality Controller Beauty Parlour / Hair Saloon / Tattoo Parlour>Private Employee>Beauty Parlour (Business Setup) Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Beauty Parlour (Business Setup) Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Beauty Parlour (Service on demand)/ Operations without Set-up Beauty Parlour / Hair Saloon / Tattoo Parlour>Private Employee>Coaching Centre Beauty Parlour / Hair Saloon / Tattoo Parlour>Trader/Retailer>Cosmetic Products/Accessories & Other Supplies Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Hair Saloon (with Business Setup) Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Hair Saloon/Tattoo (Street Hawker) Beauty Parlour / Hair Saloon / Tattoo Parlour>Private Employee>Helper Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Makeup Artist/Hairdresser Beauty Parlour / Hair Saloon / Tattoo Parlour>Trader/Retailer>Saloon / Beauty parlour material Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Tattoo Parlour Beauty Parlour / Hair Saloon / Tattoo Parlour>Service Provider>Telecaller BPO>Private Employee>Customer Care BPO>Private Employee>Management BPO>Service Provider>Medical Billing & Back-office Services Provider BPO>Private Employee>Office Executive Brooms Traders (All House Cleaning item hand made)>Manufacturer>Broom/Rope Manufacturers Brooms Traders (All House Cleaning item hand made)>Trader>Broom/Rope Traders Cable TV Operator and Video Parlor>Private Employee>Cable TV & Internet Cable TV Operator and Video Parlor>Service Provider>Cable TV & Internet Cable TV Operator and Video Parlor>Service Provider>Video/Game Parlour Cartons>Manufacturer>Carton Maker/Manufacturer Ceramics, Sanitary ware & Crockery>Private Employee>Casual Labour Ceramics, Sanitary ware & Crockery>Private Employee>Sales Executive Charitable Organization>Private Employee>Attender / Administrative Support Staff Charitable Organization>Private Employee>Casual Labour Charitable Organization>Private Employee>Office Executive Chemical & Fertilizer>Manufacturer>Chemical production Chemical & Fertilizer>Private Employee>Factory Worker Chemical & Fertilizer>Trader>Fertilizers Shop Chemical & Fertilizer>Private Employee>Lab Technician Chemical & Fertilizer>Private Employee>Management Chemical & Fertilizer>Private Employee>Market Development/Sales Chemical & Fertilizer>Trader>Pesticides Shop Chemical & Fertilizer>Private Employee>Supervisor Clothing & Fashion>Service Provider>Accounting Clothing & Fashion>Private employee>Administration Clothing & Fashion>Trader/Retailer>Boutique/Designer Clothing & Fashion>Service Provider>Cashier Clothing & Fashion>Private Employee>Casual Labour Clothing & Fashion>Private Employee>Casual Labour Clothing & Fashion>Private Employee>Dyeing & Processing Clothing & Fashion>Service Provider>Embroidery Clothing & Fashion>Private Employee>Factory Worker Clothing & Fashion>Private Employee>Field Staff Clothing & Fashion>Trader/Retailer>Garments (Hawker) Clothing & Fashion>Manufacture>Garments/Textiles Clothing & Fashion>Trader/Retailer>Garments/Textiles shop Clothing & Fashion>Private Employee>Handicraft Clothing & Fashion>Private Employee>Helper Clothing & Fashion>Service Provider>Job work Clothing & Fashion>Private Employee>Machine Operator Clothing & Fashion>Private Employee>Management Clothing & Fashion>Private Employee>Management Clothing & Fashion>Private Employee>Office executive Clothing & Fashion>Private Employee>Office Executive Clothing & Fashion>Private Employee>Office Executive Clothing & Fashion>Service Provider>Operations Clothing & Fashion>Private Employee>Painter/Painting Contractor Clothing & Fashion>Private Employee>Production Department Clothing & Fashion>Private Employee>Quality Controller Clothing & Fashion>Private Employee>Sales Executive Clothing & Fashion>Private Employee>Supervisor Clothing & Fashion>Private Employee>Supervisor (Textile / Cloth Packaging) Clothing & Fashion>Service Provider>Tailoring Clothing & Fashion>Private Employee>Technical work Clothing & Fashion>Service Provider>Warehousing Clothing & Fashion>Private Employee>Worker Commission Agent>Service Provider>Real Estate Agent/Broker Construction Industry>Private Employee>Accounting Construction Industry>Private Employee>Administrative / Office Staff Construction Industry>Private Employee>Administrative Staff Construction Industry>Service Provider>Analayst Construction Industry>Manufacturer>Brick Maker Construction Industry>Private Employee>Brick Maker Construction Industry>Trader>Building Material supplier with Setup Construction Industry>Trader>Building Material supplier without Setup Construction Industry>Private Employee>Casual Labour Construction Industry>Trader>Ceramics, Sanitary ware & Crockery Construction Industry>Manufacturer>Ceramics, Sanitary ware & Crockery manufacturing setup Construction Industry>Service Provider>Civil Contractor Construction Industry>Service Provider>Construction Equipment Rental Construction Industry>Trader>Dealer in Construction Equipment Construction Industry>Private Employee>Designer Construction Industry>Service Provider>Driver Construction Industry>Service Provider>Driver Construction Industry>Private Employee>Electrician / electrical contractor Construction Industry>Service Provider>Electrician / electrical contractor Construction Industry>Service Provider>Electrician/Plumber With Business Setup Construction Industry>Private Employee>Field Staff Construction Industry>Manufacturer>Hardware / Sanitary/Paint/Varnish Items Construction Industry>Private Employee>Hardware / Sanitary/Paint/Varnish Items Construction Industry>Trader>Hardware / Sanitary/Paint/Varnish Items Construction Industry>Private Employee>Helper Construction Industry>Service Provider>Job work in Ceramics, Sanitary ware & Crockery Construction Industry>Service Provider>Labour Contractor Construction Industry>Private Employee>Labourer Construction Industry>Trader>Marble/Granite Construction Industry>Private Employee>Mason/Bricklayer Construction Industry>Service Provider>Mason/Bricklayer Construction Industry>Private Employee>Office Executive Construction Industry>Service Provider>Painter/Painting Contractor Construction Industry>Service Provider>Plumber/Plumber Contractor Construction Industry>Employee>Production Department Construction Industry>Private Employee>Sales Executive Construction Industry>Private Employee>Site Supervisor Construction Industry>Private Employee>Supervisor Construction Industry>Private Employee>Technical work Construction Industry>Private Employee>Worker Corporate Services>Private Employee>Executive Corporate Services>Private Employee>Management Courier>Private Employee>Courier Company Staff / Operations Courier>Service Provider>Courier Franchisee Courier>Private Employee>Delivery Courier>Private Employee>Helper Courier>Service Provider>Management Courier>Private Employee>Operations Customer Essential Services >Service Provider>Common Service Centre Cycle Repairing & Spare Parts >Trader>Sale & Repairing Shop Diamond >Service Provider>Broker Diamond >Trader>Diamond Dealer Diamond >Service Provider>Diamond Polish Work Diamond >Private Employee>Factory Worker Diamond >Private Employee>Job Worker Diamond >Service Provider>Job Worker Diamond >Private Employee>Machine Operator Diamond >Private Employee>Worker E-commerce >Private Employee>Operations E-commerce >Private Employee>Sales Executive Education>Private Employee>Attender / Administrative Support Staff Education>Private Employee>Attender/Administrative Support Staff Education>Private Employee>Clerk Education>Private Employee>Coaching Centre Education>Private Employee>Cook Education>Government Employee>Counsellor Education>Private Employee>Driver Education>Private Employee>Helper Education>Private Employee>Hostel Attendant Education>Service Provider>Library Education>Government Employee>Professor/Teacher Education>Private Employee>Professor/Teacher Education>Service Provider>Sales Executive Education>Private Employee>School / College Support Staff Education>Private Employee>School / College Support Staff Education>Private Employee>School Staff Education>Government Employee>School Staff Education>Private Employee>School Staff Education>Private Employee>Support staff Education>Private Employee>Teaching Education >Service Provider>Care taker Electronic/Home Appliance (TV, Fridge, Mixer Grinder etc)>Trader>Distributor Electronic/Home Appliance (TV, Fridge, Mixer Grinder etc)>Manufacturer>Electronic/Home Appliance Electronic/Home Appliance (TV, Fridge, Mixer Grinder etc)>Trader>Electronics shop (sale) Electronic/Home Appliance (TV, Fridge, Mixer Grinder etc)>Private Employee>Sales Executive Electronic/Home Appliance (TV, Fridge, Mixer Grinder etc)>Service Provider>Service & Repairs Electronics, IT & Telecom>Private Employee>Accounting Electronics, IT & Telecom>Private Employee>Analyst Electronics, IT & Telecom>Service Provider>Analyst Electronics, IT & Telecom>Private Employee>Associate Electronics, IT & Telecom>Manufacturer>Computer / Mobile Electronics, IT & Telecom>Trader>Computer / Mobile Distributor Electronics, IT & Telecom>Trader>Computer / Mobile Shop Electronics, IT & Telecom>Service Provider>Computer Repairing Electronics, IT & Telecom>Private Employee>Consultant Electronics, IT & Telecom>Private Employee>Customer Care Electronics, IT & Telecom>Private Employee>Digital Marketing Electronics, IT & Telecom>Service Provider>Digital Seva / Online Common Service Centre Electronics, IT & Telecom>Service Provider>Document Specialist Electronics, IT & Telecom>Service Provider>Electronics Repairing Electronics, IT & Telecom>Private Employee>Engineer Electronics, IT & Telecom>Service Provider>Engineering Electronics, IT & Telecom>Private Employee>Executive Electronics, IT & Telecom>Private employee>Human Resource Department Electronics, IT & Telecom>Private Employee>Listing Specialist Electronics, IT & Telecom>Private Employee>Machine Operator Electronics, IT & Telecom>Private Employee>Management Electronics, IT & Telecom>Trader>Mobile Accessories & Repairing Electronics, IT & Telecom>Private Employee>Office Executive Electronics, IT & Telecom>Private Employee>Operations Electronics, IT & Telecom>Private Employee>Sales Executive Electronics, IT & Telecom>Private employee>Scientist Electronics, IT & Telecom>Private Employee>Service & Repairs Electronics, IT & Telecom>Service Provider>Software Electronics, IT & Telecom>Service Provider>Software Developer Electronics, IT & Telecom>Private Employee>Software Engineer Electronics, IT & Telecom>Service Provider>Sports Assisstant Electronics, IT & Telecom>Private Employee>Supervisor Electronics, IT & Telecom>Private Employee>Technical work Electronics, IT & Telecom>Service Provider>Technician Electronics, IT & Telecom>Private Employee>Technician / Operator (Electrical Equipment) Electronics, IT & Telecom>Private Employee>Typing/Shorthand/basic Computers Electronics, IT & Telecom>Service Provider>Watch Repairing Shop Electronics, IT & Telecom>Private Employee>Worker Electronics, IT & Telecom>Service Provider>Worker Elevators & Lift>Private Employee>Promotion manager Engineering>Private Employee>Accounting Engineering>Private Employee>Clerk Engineering>Private Employee>Driver Engineering>Employee>Electrician Engineering>Private Employee>Engineer Engineering>Private Employee>Helper Engineering>Private Employee>House Keeping Services provider Engineering>Private Employee>Machine Operator Engineering>Private Employee>Management Engineering>Private Employee>Office Executive Engineering>Private Employee>Production Department Engineering>Private Employee>Sales Executive Engineering>Private Employee>Service & Repairs Engineering>Private Employee>Supervisor Engineering>Private Employee>Supervisor Engineering>Private Employee>Technical work Engineering>Private Employee>Tool Maker / Skilled Machinist Engineering>Employee>worker Engineering>Private Employee>Worker Entertainment & Event service>Private Employee>Dance Instructor Entertainment & Event Service>Service Provider>Music Director Entertainment and Events Services>Service Provider>Artist Event Management>Service Provider>Band Music Business Event Management>Private Employee>Casual Labour Event Management>Service Provider>Decorators Event Management>Service Provider>DJ/Sound Services Event Management>Private Employee>Driver Event Management>Service Provider>Event Organiser Event Management>Service Provider>Event Planner/Organizer Event Management>Service Provider>Marriage Hall Event Management>Service Provider>Rentals (chair, vessels, lights, speakers, Tent etc) Facilities Management>Private Employee>Accounting Facilities Management>Private Employee>Administrative Staff Facilities Management>Private Employee>Attender / Administrative Support Staff Facilities Management>Private Employee>Care Taker Facilities Management>Private Employee>Care Taker Facilities Management>Private Employee>Casual Labour Facilities Management>Private Employee>Cook Facilities Management>Private Employee>Field Staff Facilities Management>Private Employee>Guard Facilities Management>Private Employee>Helper Facilities Management>Private Employee>House Keeping Services provider Facilities Management>Private Employee>Labour Contractor Facilities Management>Private Employee>Office Executive Facilities Management>Private Employee>Safety and security Facilities Management>Private Employee>Supervisor Facilities Management>Private Employee>Support staff Facilities Management>Private Employee>Sweeper Facilities Management>Private Employee>Technical work Facilities Management>Private Employee>Typing/Shorthand/basic Computers Farming & Animal Husbandry>Employee>Agro Product Distribution and Logistics Farming & Animal Husbandry>Manufacturer>Bamboo business / related products Farming & Animal Husbandry>Private Employee>Casual Labour Farming & Animal Husbandry>Manufacturer>Charcoal Manufacturing Farming & Animal Husbandry>Private Employee>Delivery Farming & Animal Husbandry>Manufacturer>Farming of Crops/Vegetables Farming & Animal Husbandry>Private Employee>Farming of Crops/Vegetables Farming & Animal Husbandry>Manufacturer>Fish farming Farming & Animal Husbandry>Private Employee>Forklift driver Farming & Animal Husbandry>Manufacturer>Goat farming Farming & Animal Husbandry>Service Provider>Harvester Services Farming & Animal Husbandry>Private Employee>Helper Farming & Animal Husbandry>Manufacturer>Mushroom seeds and trading Farming & Animal Husbandry>Private Employee>Office Executive Farming & Animal Husbandry>Manufacturer>Pet farming Farming & Animal Husbandry>Manufacturer>Poultry Farm Farming & Animal Husbandry>Service Provider>Supervisor Farming & Animal Husbandry>Service Provider>Tractor/Tillage Services Farming & Animal Husbandry>Service Provider>Wholesale Distribution Financial Services - Investment / Consultancy>Private Employee>Accounting Financial Services - Investment / Consultancy>Private Employee>Cashier (Banking) Financial Services - Investment / Consultancy>Private Employee>Clerk Financial Services - Investment / Consultancy>Private Employee>Clerk Financial Services - Investment / Consultancy>Private Employee>Consultant Financial Services - Investment / Consultancy>Government Employee>Credit & Operations Financial Services - Investment / Consultancy>Service Provider>Currency Dealer Financial Services - Investment / Consultancy>Private Employee>Driver Financial Services - Investment / Consultancy>Private Employee>Field Staff Financial Services - Investment / Consultancy>Private Employee>Helper Financial Services - Investment / Consultancy>Private Employee>HR – Deputy Manager Financial Services - Investment / Consultancy>Service Provider>Insurance Advisory Financial Services - Investment / Consultancy>Private Employee>Investment Consultancy Financial Services - Investment / Consultancy>Service Provider>Investment Consultancy Financial Services - Investment / Consultancy>Service Provider>LIC Agent Financial Services - Investment / Consultancy>Private Employee>Management Financial Services - Investment / Consultancy>Private Employee>Management Financial Services - Investment / Consultancy>Private Employee>Management Financial Services - Investment / Consultancy>Private Employee>Office executive Financial Services - Investment / Consultancy>Private Employee>Office Executive Financial Services - Investment / Consultancy>Private Employee>Office Executive Financial Services - Investment / Consultancy>Service Provider>Post Office Agent Financial Services - Investment / Consultancy>Private Employee>Sales Executive Financial Services - Investment / Consultancy>Private Employee>Sales Executive Financial Services - Investment / Consultancy>Private Employee>Sales Executive Financial Services - Investment / Consultancy>Private Employee>Supervisor Financial Services - Investment / Consultancy>Government Employee>Support Staff Financial Services - Investment / Consultancy>Private Employee>Valuer Flower shop>Trader>Car/Marriage/Party Decorator Flower shop>Trader>Flower Shop with Permanent setup Flower shop>Trader>Street hawker FMCG>Private Employee>Management FMCG >Private Employee>Casual Labour FMCG >Private Employee>Driver FMCG >Private Employee>Office Executive FMCG >Private Employee>Sales Executive Food and Beverage Sector>Private Employee>Accounting Food and Beverage Sector>Private employee>Assistant/Clerk/Housekeeper Food and Beverage Sector>Service Provider>Bakery Shop Food and Beverage Sector>Manufacturer>Bidi Works / Tobacco Food and Beverage Sector>Service Provider>Cashier Food and Beverage Sector>Private Employee>Casual Labour Food and Beverage Sector>Service Provider>Catering Food and Beverage Sector>Trader>Chicken/Mutton Shop Food and Beverage Sector>Service Provider>Cold Storage Food and Beverage Sector>Private Employee>Cook Food and Beverage Sector>Private Employee>Cook Food and Beverage Sector>Service Provider>Delivery Food and Beverage Sector>Trader>Distributor/Wholesaler Food and Beverage Sector>Trader>Dry Fruit Food and Beverage Sector>Manufacturer>Farming of Crops/Vegetables Food and Beverage Sector>Service Provider>Fast food centre Food and Beverage Sector>Trader>Fish Shop Food and Beverage Sector>Trader>Flour Mill with business setup Food and Beverage Sector>Private Employee>Food Processing Food and Beverage Sector>Service Provider>Food processing Food and Beverage Sector>Private Employee>Helper Food and Beverage Sector>Service Provider>Home Made Food Product / Papad Making Food and Beverage Sector>Private Employee>Hotel/Restaurant Services Food and Beverage Sector>Private Employee>Hotel/Restaurant services Food and Beverage Sector>Service Provider>Ice Cream Parlour & Juice Food and Beverage Sector>Trader>Kirana shop/general store Food and Beverage Sector>Private Employee>Machine Operator Food and Beverage Sector>Private Employee>Management Food and Beverage Sector>Private Employee>Office executive Food and Beverage Sector>Trader>Oil Mill Food and Beverage Sector>Trader>PAN parlour, cold drink and General Food and Beverage Sector>Private Employee>Production Department Food and Beverage Sector>Trader>Res-cum-business with small machines for individual households - Flour Mill Food and Beverage Sector>Private Employee>Restaurant / Dhaba Food and Beverage Sector>Service Provider>Restaurant / Dhaba Food and Beverage Sector>Service Provider>Safety & Security Food and Beverage Sector>Private Employee>Sales Executive Food and Beverage Sector>Service Provider>Street Food Hawker Food and Beverage Sector>Private Employee>Supervisor Food and Beverage Sector>Service Provider>Sweet/Snack Shop Food and Beverage Sector>Service Provider>Tea stall Food and Beverage Sector>Service Provider>Tiffin Centre & Mess Food and Beverage Sector>Private Employee>Worker Footwear>Manufacture>Footwear Footwear>Trader/Retailer>Footwear (Hawker) Footwear>Trader/Retailer>Footwear shop Footwear>Service Provider>Job work Footwear>Service Provider>Mochi/Footwear Repair/Cobler Footwear>Private Employee>Operations Footwear>Private Employee>Production Department Footwear>Private Employee>Salaried employee Footwear>Private Employee>Worker Fruits / Vegetables Vendor>Trader>Fruit/Vegetable supplier / wholesaler Fruits / Vegetables Vendor>Trader>Fruit/Vegetable Vendor (Hawker) Fruits / Vegetables Vendor>Trader>Fruit/Vegetable Vendor (With Business Setup) Glass works>Service Provider>Glass & Glass Products Glass works>Trader>Glass & Glass Products Government & Public Services>Service Provider>Secretary Government / Public Services>Government Employee>Aanganwadi / Social Welfare Worker Government / Public Services>Government Employee>Accounting Government / Public Services>Government Employee>Attender / Administrative Support Staff Government / Public Services>Government Employee>Casual Labour Government / Public Services>Government Employee>Clerk Government / Public Services>Government Employee>Clerk (Gram Panchayat Office) Government / Public Services>Government Employee>Cook Government / Public Services>Government Employee>Driver Government / Public Services>Government Employee>Engineer Government / Public Services>Government Employee>Guard Government / Public Services>Government Employee>Housekeeping / Sanitation Worker Government / Public Services>Government Employee>Nurse Government / Public Services>Government Employee>Office Executive Government / Public Services>Government Employee>Pensioner Government / Public Services>Government Employee>Police Government / Public Services>Government Employee>Sales Executive Government / Public Services>Government Employee>School Teacher Government / Public Services>Government Employee>Social Worker Government / Public Services>Government Employee>Support staff Government / Public Services>Government Employee>Sweeper Government / Public Services>Government Employee>Technical work Government / Public Services>Government Employee>Typing/Shorthand/basic Computers Government / Public Services>Government Employee>Worker Government/Public Services>Government Employee>Helper Government/Public Services>Government Employee>Management Government/Public Services>Government Employee>Office executive Government/Public Services>Government Employee>Pensioner Government/Public Services>Government Employee>Police Government/Public Services>Government Employee>Postal Services Government/Public Services>Government Employee>Ticket Collector(Conductor) Government/Public Services>Government Employee>Welfare Officer Government/Public Services>Service Provider>Worker Gym / Wellness Centre>Private Employee>Accounting Gym / Wellness Centre>Service Provider>Gym Franchisee Gym / Wellness Centre>Private Employee>Gym Trainer Gym / Wellness Centre>Service Provider>Gym Trainer Gym / Wellness Centre>Private Employee>Helper Gym / Wellness Centre>Service Provider>Local Gym Gym / Wellness Centre>Service Provider>Yoga/Naturopathy Handicraft/Handloom>Service Provider>Handicraft Handicraft/Handloom>Service Provider>Handloom Handicraft/Handloom>Service Provider>Sculptor Handicraft/Handloom>Service Provider>Stall at pilgrim centres Health Care>Private Employee>Accounting Health Care>Private Employee>Admin/ Support Services Health Care>Private Employee>Attender / Administrative Support Staff Health Care>Service Provider>Ayurvedic / Homeopathic/ Unani Doctor Health Care>Private Employee>Casual Labour Health Care>Private Employee>Clerk Health Care>Private Employee>Customer Care Health Care>Employee>Distribution Health care>Private Employee>Doctor Health Care>Service Provider>Doctor Health Care>Private Employee>Driver Health Care>Private Employee>Driver Health Care>Private Employee>Executive Health Care>Service Provider>First Aid centre Health care>Private Employee>Hospital support Staff Health Care>Private Employee>House Keeping Services provider Health care>Private Employee>Human Resource Department Health Care>Private Employee>Lab Technician Health care>Private Employee>Machine Operator Health Care>Private Employee>Management Health Care>Manufacturer>Medical Equipment Health Care>Trader>Medical Equipment Health Care>Manufacturer>Medical/Herbal Product Health Care>Trader/Retailer>Medical/Herbal Product Health Care>Employee>Nursing & Medical Staff Services Health Care>Private Employee>Nursing and medical staff services Health Care>Private Employee>Office Executive Health Care>Private Employee>Pharamacist Health Care>Private Employee>Production Department Health Care>Private Employee>Sales Executive Health Care>Private Employee>Supervisor Health Care>Private Employee>Support staff Health Care>Private Employee>Sweeper Health Care>Private Employee>Technical work Health Care>Private Employee>Worker Hospitality>Private employee>Support Staff Hospitality >Private Employee>Cook Hospitality >Private Employee>Helper Hospitality >Private Employee>Management Hospitality >Private Employee>Supervisor Hotel / Guest House>Private Employee>Carpenter / Carpenter Contractor Hotel / Guest House>Private Employee>Cook Hotel / Guest House>Private Employee>Guard Hotel / Guest House>Service Provider>Guest House/ PG Hotel / Guest House>Service Provider>Hotel with boarding/lodging facility Hotel / Guest House>Private Employee>Religious/ Pandit Services House Keeping>Private Employee>Helper House Keeping>Private Employee>Homemaker House Keeping>Private Employee>House Keeping Services provider House Keeping>Service Provider>House Keeping Services provider House Keeping>Private Employee>Supervisor Household / Domestic Services>Service Provider>House Maid / Domestic Worker Interior Designer / Architect>Private Employee>Accounting Interior Designer / Architect>Service Provider>Architect Interior Designer / Architect>Private Employee>Driver Interior Designer / Architect>Service Provider>Interior Designer Interior Designer / Architect>Service Provider>Worker Jewellery - Imitation / Gold / Silver / Stones>Trader>Gold and Silver shop Jewellery - Imitation / Gold / Silver / Stones>Private Employee>Helper Jewellery - Imitation / Gold / Silver / Stones>Manufacturer>Imitation Jewellery Jewellery - Imitation / Gold / Silver / Stones>Trader>Imitation Jewellery Jewellery - Imitation / Gold / Silver / Stones>Service Provider>Job Worker Jewellery - Imitation / Gold / Silver / Stones>Private Employee>Office Executive Jewellery - Imitation / Gold / Silver / Stones>Private Employee>Production Department Jewellery - Imitation / Gold / Silver / Stones>Private Employee>Quality Controller Jewellery - Imitation / Gold / Silver / Stones>Private Employee>Sales Executive Kites Business>Manufacturer>Kite Maker/Manufacturer Kites Business>Trader>Kite Trader Landlord (Rental Income)>Service Provider>commercial property Landlord (Rental Income)>Service Provider>Residential property Laundry & Dry Cleaners>Service Provider>Dhobi Laundry & Dry Cleaners>Service Provider>Laundry/Dry Cleaner Leasehold>Private employee>Sales Executive Legal Related Services>Private Employee>Deed Writer/ typist/ Notary work Legal Related Services>Service Provider>Deed Writer/ typist/ Notary work Legal Related Services>Private Employee>Office Executive Legal Related Services>Private Employee>Typing/Shorthand/basic Computers Liqour>Private Employee>Accounting Livestock Trader>Trader/Retailer>Livestock Trader Luggage /Bag>Manufacturer>Bag maker/Bag factory Luggage /Bag>Service Provider>Bag repair Luggage /Bag>Trader>Bag Seller Hawker Luggage /Bag>Trader>Bag Seller with Business setup Manufacturing>Service Provider>Engineer Manufacturing>Private Employee>Helper Manufacturing>Manufacturer>Machine manufacturer Manufacturing>Private Employee>Machine Operator Manufacturing>Private Employee>Machine Operator Manufacturing>Private Employee>Machine Operator Manufacturing>Private Employee>Office executive Manufacturing>Private Employee>Office Executive Manufacturing>Private Employee>Office executive/Production-related work Manufacturing>Private Employee>Production Department Manufacturing>Private Employee>Quality Control Manufacturing>Private Employee>Supervisor Manufacturing>Private Employee>Tailoring Manufacturing >Private Employee>Care Taker Manufacturing >Private Employee>Electrician / electrical contractor Manufacturing & Fabrication>Private Employee>Casual Labour Manufacturing & Fabrication>Private Employee>Factory Worker Manufacturing & Fabrication>Private Employee>Helper Manufacturing & Fabrication>Private Employee>Machine Operator Manufacturing & Fabrication>Service Provider>Mechanic Manufacturing & Fabrication>Private Employee>Office Executive Manufacturing & Fabrication>Private Employee>Processing Assistant Manufacturing & Fabrication>Private Employee>Production Department Manufacturing & Fabrication>Private Employee>Quality Control Manufacturing & Fabrication>Private Employee>Sales & Marketing Manufacturing & Fabrication>Private Employee>Sales Executive Manufacturing & Fabrication>Private Employee>Supervisor Manufacturing & Fabrication>Private Employee>Support staff Manufacturing & Fabrication>Private Employee>Technical work Manufacturing & Fabrication>Private Employee>Worker Marble/Granite>Private Employee>Machine Operator Marine & Shipping>Private Employee>Office Executive Marine & Shipping>Private Employee>Technical work Medical Shop>Trader>Ayurvedic / Homeopathic Medical & General Shop Medical Shop>Service Provider>Chemist Medical Shop>Private Employee>Medical & General Shop Medical Shop>Trader>Medical & General Shop Medical Shop>Private Employee>Salesman (Medical Store) Metal work>Private Employee>Accounting Metal work>Service Provider>Aluminium work & Fabrication Metal work>Trader>Aluminium work & Fabrication Metal Work>Service Provider>Electrician Metal work>Private Employee>Engg workshop / Welding / Moulding Metal work>Service Provider>Engg workshop/ Welding/Moulding Metal work>Service Provider>Job worker Metal work>Private Employee>Machine Operator Metal work>Trader>Metal Products Metal work>Service Provider>Metal work Metal work>Private Employee>Office Executive Metal work>Private Employee>Production Department Metal Work>Private Employee>Technician Milk Business/Dairy>Private Employee>Driver Milk Business/Dairy >Service Provider>Agency/Collection/Distributor Milk Business/Dairy >Service Provider>Cattle Dairy Business Milk Business/Dairy >Service Provider>Milk Dairy shops Milk Business/Dairy >Private Employee>Sales Executive Mining>Private Employee>Engineer Mining>Private Employee>Machine Operator Mining>Manufacturer>Mining and Tunneling Mining>Private Employee>Supervisor Mining>Private Employee>Upstream Drilling/Rig Operations Mining>Private Employee>Worker Musical instrument>Trader>Musical instrument dealer Musical instrument>Manufacturer>Musical instrument manufacturer News Agency>Service Provider>News Paper Agency News Paper Vendor>Trader>News Paper Stall NGO>Private Employee>Therapist Non-Profit Organization>Service Provider>Management Nursery / Plant Business>Manufacturer>Owning Farm Lands Nursery / Plant Business>Trader>Sales point for Nursery/Plant business Optical & Medical Products>Service Provider>Sales Executive Other>Private Employee>Accounting Other>Private Employee>Attender / Administrative Support Staff Other>Private Employee>Casual Labour Other>Private Employee>Casual Labour Other>Private Employee>Clerk Other>Private Employee>Helper Other>Other>Homemaker Other>Private Employee>Machine Operator Other>Private Employee>Office Executive Other>Private Employee>Sales Executive Other>Private Employee>Supervisor Others>Employee>Driver Packaging>Private Employee>Packaging Worker / Labour Packaging and Disposable Items>Private Employee>Casual Labour Packaging and Disposable Items>Private Employee>Helper Packaging and Disposable Items>Private Employee>Machine Operator Packaging and Disposable Items>Private Employee>Management Packaging and Disposable Items>Manufacturer>Packaging and Disposable Items Packaging and Disposable Items>Service Provider>Packaging and Disposable Items Packaging and Disposable Items>Trader>Packaging and Disposable Items Packaging and Disposable Items>Private Employee>Production Department Packaging and Disposable Items>Private Employee>Supervisor Painting>Private Employee>Office Executive Painting>Private Employee>Painter/Painting Contractor Paper Manufacturing>Private Employee>Machine Operator Paper Manufacturing>Private Employee>Worker Pest Control>Service Provider>Pest Control Services with Business Setup Pest Control>Service Provider>Pest Control Services without Business Setup Petrol Pump & Gas Agency>Private Employee>Casual Labour Petrol Pump & Gas Agency>Trader>CNG Station Petrol Pump & Gas Agency>Private Employee>Driver Petrol Pump & Gas Agency>Private Employee>Field Staff Petrol Pump & Gas Agency>Trader>Gas Agency Petrol Pump & Gas Agency>Trader>LPG Dealers Petrol Pump & Gas Agency>Private Employee>Operations Petrol Pump & Gas Agency>Private Employee>Petrol Pump Petrol Pump & Gas Agency>Trader>Petrol Pump Petrol Pump & Gas Agency>Private Employee>Sales Executive Petrol Pump & Gas Agency>Private Employee>Supervisor Petrol Pump & Gas Agency>Private Employee>Technical work Petrol Pump & Gas Agency>Private Employee>Worker Pets shop, Aquarium>Trader>Aquarium Pets shop, Aquarium>Trader>Pet Shop Pharmaceuticals>Private Employee>Driver Pharmaceuticals>Private Employee>Management Pharmaceuticals>Private Employee>Sales Executive Pharmaceuticals>Private Employee>Worker Photography / Digital Studio>Private Employee>Helper Photography / Digital Studio>Service Provider>Music Recording Studio Photography / Digital Studio>Service Provider>Photographer Photography / Digital Studio>Private Employee>Photography shop/studio Photography / Digital Studio>Service Provider>Photography shop/studio Plastic Items>Private Employee>Casual Labour Plastic Items>Private Employee>Driver Plastic Items>Private Employee>Factory Worker/Shop Floor helper Plastic Items>Private Employee>Helper Plastic Items>Service Provider>Management Plastic Items>Manufacturer>Trading in plastic Items Plastic Items>Trader>Trading in plastic Items Plastic Items>Private Employee>Worker Plumbing / Sanitary Ware>Private Employee>Casual Labour Potter (Matke wala ) manufacture and sale >Manufacturer>Potter (Matka Maker) Potter (Matke wala ) manufacture and sale >Trader>Potter (Matka Trader) Power Generation>Government Employee>Field staff Power generation>Private Employee>Machine Operator Power generation>Private Employee>Mechanic Power Generation>Government Employee>Office Executive Power Generation>Government Employee>Production Department Power Generation>Private Employee>Production Department Power generation>Private Employee>Production Department Power generation>Private Employee>Sales Executive Power generation>Private Employee>Technical work Power Loom>Service Provider>Job worker Power Loom>Manufacturer >Power Loom factory Printing & Packaging Services>Private Employee>Printing Services Printing Press / Graphics>Private Employee>Casual Labour Printing Press / Graphics>Private Employee>Editorial/Publishing Services Printing Press / Graphics>Service Provider>Graphic Designer Printing Press / Graphics>Private Employee>Management Printing Press / Graphics>Service Provider>Printing Press Printing Press / Graphics>Private Employee>Sales Executive Professional Services - CA / CS / ICWA / Advocate>Private Employee>Accounting Professional Services - CA / CS / ICWA / Advocate>Service Provider>Advocate Professional Services - CA / CS / ICWA / Advocate>Service Provider>CA Professional Services - CA / CS / ICWA / Advocate>Service Provider>CS Professional Services - CA / CS / ICWA / Advocate>Private Employee>HR Executive Professional Services - CA / CS / ICWA / Advocate>Service Provider>Management Professional Services - CA / CS / ICWA / Advocate>Private Employee>Office Executive Professional Services - CA / CS / ICWA / Advocate>Service Provider>Tax/Consultancy Professional Services - CA / CS / ICWA / Advocate>Private Employee>Trainee Professional Services - CA / CS / ICWA / Advocate>Service Provider>Worker Professional Services - HR/Recruitment Services>Private Employee>Office Executive Professional Services-HR/Recruitment Services>Private Employee>Recruiter/Staffing Consultant Professional Services-HR/Recruitment Services>Private Employee>Support Staff Public Administration & Defence>Government Employee>Armed Forces/Fire/Rescue services Public Administration & Defence>Government Employee>Charge/Telecom Mechanic Railways>Government Employee>Office Executive Railways>Government Employee>Pensioner Railways>Government Employee>Pointsman Railways>Government Employee>Station Master Railways>Government Employee>Technical work Real Estate>Service Provider>Consultancy Real Estate >Private Employee>Field Staff Real Estate >Private Employee>Management Real Estate >Private Employee>Office Executive Real Estate >Private Employee>Sales Executive Religious Services & Products>Service Provider>Astrologer/Vastu Consultant Religious Services & Products>Private Employee>Office Executive Religious Services & Products>Manufacturer>Religious Products (Pooja samagri,etc) Religious Services & Products>Trader>Religious Products (Pooja samagri,etc) Religious Services & Products>Service Provider>Religious/ Pandit Services Retail>Private Employee>Accounting Retail>Private Employee>Accounting Retail>Private Employee>Cashier (Dmart Store) Retail>Service Provider>Distribution Retail>Private Employee>Field Staff Retail>Trader>General store - Non food (Cutlery store) Retail>Private Employee>Helper Retail>Private Employee>Machine Operator Retail>Private Employee>Management Retail>Private Employee>Office executive Retail>Private Employee>Office Executive Retail>Private Employee>Operations Retail>Service Provider>Recovery Services/Agent Retail>Government Employee>Sales Executive Retail>Private Employee>Sales Executive Retail>Private Employee>Sales Man Retail>Private Employee>Supervisor Retail>Private Employee>Supervisor Rubber & rubber products>Manufacturer>Manufacturer of Rubber, rubber products Rubber & rubber products>Private Employee>Office executive Rubber & rubber products>Trader>Trading in Rubber, rubber products Sales and Field Marketing Services>Private Employee>Field Supervisor Sales and Field Marketing Services>Private Employee>Office executive Scrap Dealer>Trader>Homebased scrap dealer Scrap Dealer>Trader>Industrial Scrap dealer Scrap Dealer>Trader>Plastic Recycle Work Security Services>Private Employee>Attender / Administrative Support Staff Security Services>Private Employee>Commercial Security Security Services>Service Provider>Commercial Security Security Services>Service Provider>Driver Security Services>Service Provider>Driver Security Services>Private Employee>Guard Security Services>Private Employee>Helper Security Services>Service Provider>Labour / Helper Security Services>Service Provider>Labour Contractor Security Services>Private Employee>Office executive Security Services>Private Employee>Office Executive Security Services>Service Provider>Residential Security Security Services>Government Employee>Safety and Security Services Security Services>Private Employee>School Teacher Security Services>Service Provider>Security Guard Social / Welfare Services>Private Employee>Attender / Administrative Support Staff Spices>Trader>Dealing in spices Spices>Manufacturer>Manufacturer of spices Sports>Service Provider>Artisan Sports>Private Employee>Office Executive Sports>Private Employee>Supervisor Stationary/Gift Items>Manufacturer>Gift Items Stationary/Gift Items>Private Employee>Production Department Stationary/Gift Items>Manufacturer>Stationary Items Stationary/Gift Items>Trader>Stationary/Gift Shop Stationary/Gift Items>Private Employee>Technical work Stationary/Gift Items>Private Employee>Typing/Shorthand/basic Computers Textile Industry>Service Provider>Junior Electrician Textile Industry>Service Provider>Production-related work Textile Industry>Manufacturer & Retailer>Quilt / Mattress & Pillow Maker Tours & Travels>Service Provider>Accountant Tours & Travels>Private Employee>Administrative Staff Tours & Travels>Service Provider>Driver Tours & Travels>Private Employee>Office executive Tours & Travels>Service Provider>Provides Vehicle on Rental/Hire (No-Owned Vehicle) Tours & Travels>Service Provider>Provides Vehicle on Rental/Hire (Owned Vehicle) Tours & Travels>Service Provider>Tours & Travels Tours & Travels>Service Provider>worker Toys & Fancy Items>Trader/Retailer>Toys & Fancy Store Trading & Distribution>Private Employee>Attender / Administrative Support Staff Trading & Distribution>Private Employee>Office Executive Trading & Distribution>Private Employee>Operations Trading & Distribution>Private Employee>Sales and Marketing Trading & Distribution>Private Employee>Sales Executive Trading & Distribution>Private Employee>Supervisor Trading & Distribution>Private Employee>Worker Training Institute / Coaching Classes>Service Provider>Art/Music/Dance / Karate Classes Training Institute / Coaching Classes>Private Employee>Attender/Administrative Support Staff Training Institute / Coaching Classes>Service Provider>Clerk Training Institute / Coaching Classes>Private Employee>Coaching Centre Training Institute / Coaching Classes>Service Provider>Coaching Centre Training Institute / Coaching Classes>Service Provider>Consultancy services for students aspiring education overseas Training Institute / Coaching Classes>Service Provider>Driver Training Institute / Coaching Classes>Service Provider>Private Tuitions /tutors Training Institute / Coaching Classes>Private Employee>Support Staff Training Institute / Coaching Classes>Private Employee>Training Institute Training Institute / Coaching Classes>Service Provider>Training Institute Training Institute / Coaching Classes>Service Provider>Typing/Shorthand/basic Computers Transport & Logistics>Private Employee>Accounting Transport & Logistics>Government Employee>Bus Conductor Transport & Logistics>Private Employee>Casual Labour Transport & Logistics>Private Employee>Clerk Transport & Logistics>Service Provider>Commission Agent Transport & Logistics>Private Employee>Cook Transport & Logistics>Private Employee>Delivery Transport & Logistics>Private Employee>Denting and Painting Works Transport & Logistics>Private Employee>Driver Transport & Logistics>Service Provider>Driver Transport & Logistics>Service Provider>Driver (Without Vehicle) Transport & Logistics>Private Employee>Goods carrier Transport & Logistics>Service Provider>Goods carrier Transport & Logistics>Private Employee>Helper Transport & Logistics>Private Employee>Labour Contractor Transport & Logistics>Private Employee>Logistics/Export Operations Transport & Logistics>Private Employee>Machine Operator Transport & Logistics>Private Employee>Management Transport & Logistics>Private Employee>Management Transport & Logistics>Service Provider>Market loader/unloader Transport & Logistics>Private Employee>Mathadi / Loading-Unloading Worker Transport & Logistics>Private Employee>Office executive Transport & Logistics>Private Employee>Office Executive Transport & Logistics>Service Provider>Operations Transport & Logistics>Private Employee>Operator Transport & Logistics>Service Provider>Rapido/Zomato/Swiggy - Gig Worker Transport & Logistics>Service Provider>Rickshaw Driver (With Vehicle Ownership) Transport & Logistics>Service Provider>Rickshaw Driver (Without Vehicle Ownership) Transport & Logistics>Service Provider>School Taxi Services Transport & Logistics>Private Employee>Supervisor Transport & Logistics>Government Employee>Support Staff Transport & Logistics>Private Employee>Worker Utensils>Trader>Utensils & Crockery Shop Utensils>Manufacturer>Utensils manufacturing setup Warehouse>Private Employee>Worker Water Supplier>Service Provider>Bore wells Water Supplier>Trader>Motors , generators and pumps, Transformers dealer Water Supplier>Manufacturer>RO Plant owner Water Supplier>Trader>RO water distributor Water Supplier>Service Provider>Water Supplier Water Treatment >Private Employee>Driver Water Treatment >Private Employee>Production Department Wood/ Furniture / Home Décor>Private Employee>Attender / Administrative Support Staff Wood/ Furniture / Home Décor>Private Employee>Carpenter / Carpenter Contractor Wood/ Furniture / Home Décor>Service Provider>Carpenter / Carpenter Contractor Wood/ Furniture / Home Décor>Private Employee>Casual Labour Wood/ Furniture / Home Décor>Service Provider>Curtains/Carpets/ mattress Wood/ Furniture / Home Décor>Trader/Retailer>Curtains/Carpets/ mattress Wood/ Furniture / Home Décor>Private Employee>Driver Wood/ Furniture / Home Décor>Manufacturer>Furniture/Timber/Wood Products Wood/ Furniture / Home Décor>Trader/Retailer>Furniture/Timber/Wood Products Wood/ Furniture / Home Décor>Trader/Retailer>Home décor showpieces & fountains retailer Wood/ Furniture / Home Décor>Private Employee>Mason/Bricklayer Wood/ Furniture / Home Décor>Private Employee>Sales Executive Wood/ Furniture / Home Décor>Private Employee>Supervisor Wood/ Furniture / Home Décor>Private Employee>Technical work Wood/ Furniture / Home Décor>Private Employee>Worker """  # copy-paste exactly


def process_excel(args):
    # GEMINI_API_KEY is read from env
    client = genai.Client()

    print(f"Opening workbook: {args.wb}, sheet: {args.sheet}")
    wb = load_workbook(args.wb)
    sheet = wb[args.sheet]

    name_col = args.name_col.upper()
    comment_col = args.comment_col.upper()

    out_industry_col = "D"
    out_category_col = "E"
    out_profile_col = "F"
    out_summary_col = "G"

    # Headers
    def ensure_header(col, text):
        cell = f"{col}1"
        if not (sheet[cell].value or "").strip():
            sheet[cell].value = text

    ensure_header(out_industry_col, "Industry")
    ensure_header(out_category_col, "Business Category")
    ensure_header(out_profile_col, "Business Profile")
    ensure_header(out_summary_col, "Applicant Summary")

    start_row = args.start_row
    # 0 or None for end_row means "no upper limit"
    end_row = args.end_row if getattr(args, "end_row", None) not in (None, 0) else None
    # 0 or None for limit means "no limit"
    limit = args.limit if args.limit and args.limit > 0 else None

    total_prompt_tokens = 0
    total_output_tokens = 0
    rows_processed = 0

    print(
        f"Starting processing from row {start_row} "
        f"to {end_row if end_row is not None else 'EOF'} "
        f"with limit={limit or 'no limit'}"
    )

    current_row = start_row
    while True:
        if limit is not None and rows_processed >= limit:
            break
        if end_row is not None and current_row > end_row:
            break

        name = sheet[f"{name_col}{current_row}"].value
        comment = sheet[f"{comment_col}{current_row}"].value

        # stop when both empty
        if (name is None or str(name).strip() == "") and \
           (comment is None or str(comment).strip() == ""):
            break

        # skip rows with no comment
        if comment is None or str(comment).strip() == "":
            current_row += 1
            continue

        applicant_name = str(name or "").strip()
        cam_comment = str(comment).strip()

        user_prompt = (
            "Use the CATALOG from the system instruction.\n\n"
            f"APPLICANT_NAME:\n{applicant_name}\n\n"
            "CAM_COMMENT:\n"
            f"{cam_comment}\n\n"
            "Remember: focus ONLY on APPLICANT_NAME when returning the classification and summary."
        )

        try:
            response = client.models.generate_content(
                model="gemini-2.5-flash",  # same as your local script
                contents=user_prompt,
                config=types.GenerateContentConfig(
                    system_instruction=SYSTEM_PROMPT,
                    temperature=0.0,
                    response_mime_type="application/json",
                ),
            )
        except Exception as e:
            print(f"Error at row {current_row}: {e}")
            sheet[f"{out_industry_col}{current_row}"].value = "Error"
            sheet[f"{out_category_col}{current_row}"].value = "Error"
            sheet[f"{out_profile_col}{current_row}"].value = "Error"
            sheet[f"{out_summary_col}{current_row}"].value = str(e)
            current_row += 1
            continue

        # Extract JSON text
        content = ""
        try:
            if hasattr(response, "text") and response.text:
                content = response.text
            else:
                content = response.candidates[0].content.parts[0].text
        except Exception:
            content = ""

        industry = ""
        category = ""
        profile = ""
        summary = ""
        try:
            data = json.loads(content)
            industry = data.get("industry", "") or ""
            category = data.get("business_category", data.get("category", "")) or ""
            profile = data.get("business_profile", data.get("profile", "")) or ""
            summary = data.get("summary", "") or ""
        except Exception:
            industry = "Unknown"
            category = "Unknown"
            profile = "Unknown"
            summary = "Parsing error: could not read model output."

        sheet[f"{out_industry_col}{current_row}"].value = industry
        sheet[f"{out_category_col}{current_row}"].value = category
        sheet[f"{out_profile_col}{current_row}"].value = profile
        sheet[f"{out_summary_col}{current_row}"].value = summary

        usage = getattr(response, "usage_metadata", None)
        if usage is not None:
            pt = getattr(usage, "prompt_token_count", 0) or 0
            total = getattr(usage, "total_token_count", 0) or 0
            ot = max(total - pt, 0)
            total_prompt_tokens += pt
            total_output_tokens += ot
            print(
                f"Row {current_row} done → prompt_tokens={pt}, output_tokens={ot}, "
                f"industry='{industry}', category='{category}'"
            )
        else:
            print(
                f"Row {current_row} done (no usage_metadata) → "
                f"industry='{industry}', category='{category}'"
            )

        rows_processed += 1
        current_row += 1
        time.sleep(0.05)

    wb.save(args.wb)
    print("Excel updated and saved.")

    # Cost summary
    print("\n========== GEMINI COST SUMMARY (PAID RATES) ==========")
    print(f"Rows processed: {rows_processed}")
    print(f"Total prompt tokens: {total_prompt_tokens}")
    print(f"Total output tokens (incl. thinking): {total_output_tokens}")

    actual_cost = (
        total_prompt_tokens * INPUT_RATE +
        total_output_tokens * OUTPUT_RATE
    )
    print(f"Estimated ACTUAL cost for this run ≈ ${actual_cost:.4f}")

    if rows_processed > 0:
        per_row_cost = actual_cost / rows_processed
        print(f"Estimated cost per row ≈ ${per_row_cost:.6f}")
        projected_120k = per_row_cost * 120000
        print(f"Projected cost for 120,000 rows ≈ ${projected_120k:.2f}")
    print("=======================================================")


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Classify applicant occupations from Excel using Gemini (headless, openpyxl)"
    )

    parser.add_argument(
        "--wb",
        default="Data/AHFL Cases.xlsx",
        help="Path to Excel workbook inside repo (default: Data/AHFL Cases.xlsx)",
    )
    parser.add_argument(
        "--sheet",
        default="Sheet1",
        help="Sheet name (default: Sheet1)",
    )
    parser.add_argument(
        "--name_col",
        default="B",
        help="Column letter for applicant name (default: B)",
    )
    parser.add_argument(
        "--comment_col",
        default="C",
        help="Column letter for CAM comment (default: C)",
    )
    parser.add_argument(
        "--start_row",
        type=int,
        default=2,
        help="Row number to start from (default: 2)",
    )
    parser.add_argument(
        "--end_row",
        type=int,
        default=10000,
        help="Last row number to process (inclusive, default: 10000; 0 = no upper limit)",
    )
    parser.add_argument(
        "--limit",
        type=int,
        default=0,
        help="Max rows to process (0 = no limit, used together with start_row / end_row)",
    )

    args = parser.parse_args()
    process_excel(args)
